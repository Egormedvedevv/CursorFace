<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>CursorFace</title>
    <script>
      // Single Page Apps for GitHub Pages
      // https://github.com/rafgraph/spa-github-pages
      // This script takes the current url and converts the path and query
      // string into just a query string, and then redirects the browser
      // to the new url with only a query string and hash fragment,
      // e.g. https://username.github.io/CursorFace/main?char=1 becomes
      // https://username.github.io/CursorFace/?/main&char=1
      // Note: this 404.html file must be at least 512 bytes for it to work
      // with Internet Explorer (it is currently > 512 bytes)

      // For GitHub Pages with base path /CursorFace/, we need to preserve the base path
      var segmentCount = 1; // This will preserve /CursorFace in the path

      var l = window.location;
      var path = l.pathname;
      
      // If path starts with /CursorFace, extract everything after it
      if (path.startsWith('/CursorFace')) {
        var pathAfterBase = path.slice('/CursorFace'.length) || '/';
        var redirectPath = '/CursorFace/?/' + pathAfterBase.slice(1).replace(/&/g, '~and~');
        if (l.search) {
          redirectPath += '&' + l.search.slice(1).replace(/&/g, '~and~');
        }
        redirectPath += l.hash;
        l.replace(l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') + redirectPath);
      } else {
        // Fallback: use standard SPA redirect
        l.replace(
          l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') +
          l.pathname.split('/').slice(0, 1 + segmentCount).join('/') + '/?/' +
          l.pathname.slice(1).split('/').slice(segmentCount).join('/').replace(/&/g, '~and~') +
          (l.search ? '&' + l.search.slice(1).replace(/&/g, '~and~') : '') +
          l.hash
        );
      }
    </script>
  </head>
  <body>
  </body>
</html>
